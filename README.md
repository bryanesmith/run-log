# Run Log

## Overview
Web application for logging runs and tracking progress. Includes an AWS serverless backend and React-based frontend.

If you'd like more information on the product and the technical approach,  [review this presentation](https://docs.google.com/presentation/d/1A99DvfPVWyc-2TcBnq0_8jJZ-GgUx-0bhkbwZQlP6-s).

## Setup

Here, we'll discuss how to deploy the application to AWS using CircleCI.

For more information:
* We won't cover all the steps that happen within the CI/CD process; for more details, see `.circleci/config.yml`.
* For more details on how to build and test the front-end independently, see `frontend/README.md`.

Steps:

1. In AWS Console, under IAM > "Users", create a user with sufficient privileges.
  - You could grant `AdministratorAccess`, though that will give broader access than required; e.g., account management capabilities as well as the ability to create resources in unrelated AWS services.

1. For this user, go to "Security credentials" > "Access keys", and click "Create access key".
  - Store the secret somewhere secure; can't be retrieved again later.

1. Create an S3 bucket that will be used for serving the static web resources (HTML, CSS, JS, etc) to end users
  - Under "Permissions" > "Block public access", turn off "Block all public access"
  - Under "Permissions" > "Bucket Policy", set a bucket policy granting public access:
  ```
  {
      "Version": "2012-10-17",
      "Statement": [
          {
              "Sid": "PublicReadGetObject",
              "Effect": "Allow",
              "Principal": "*",
              "Action": "s3:GetObject",
              "Resource": "arn:aws:s3:::YOUR-BUCKET-NAME/*"
          }
      ]
  }
  ```
  - Under "Properties", enable "Static website hosting"
  - You can use the URL generated by S3; if you want to use a custom URL, though, the bucket name must match the domain name.
    - E.g., for website with URL `http://run-log.bryanesmith.com`, the bucket name would need to be `run-log.bryanesmith.com`

1. Create an S3 bucket for staging AWS assets for purposes of building and deploying

1. Review `Terraform/variables.tf`, and change any other relevant values

1. Clone this repository in GitHub

1. In CircleCI, go to "Add Projects"
  - Find "run-log", and click "Set Up Project"
  - This may initiate a build that fails, which is expected

1. In Circle CI "Jobs" > "run-log" (click gear icon) > "Environment Variables", add the following variables:
  - `AWS_ACCESS_KEY_ID`: the "Access key ID" for the IAM user you created
  - `AWS_S3_BUCKET_NAME_STAGING_ASSETS`: the name of the bucket you created above for hosting the staged assets (do _not_ include "`s3://`" prefix!)
  - `AWS_S3_BUCKET_NAME_WEB_HOST`: the name of the bucket you created above for hosting the static web resources (do _not_ include "`s3://`" prefix!)
  - `AWS_SECRET_ACCESS_KEY`: the secret key for the IAM user you created
  - `PRODUCTION_API_SERVER_BASE_URL`: e.g., "https://abc123.execute-api.us-east-1.amazonaws.com/production"

1. Whenever you push any commits to GitHub, you will trigger a new CI/CD execution in CircleCI

## Screenshots

### Login Screen

<figure>
  <kbd>
    <img src="./images/0.png">
  </kbd>
  <figcaption>Use `demo`/`demo` to log in and view demo user data.</figcaption>
</figure>

### Dashboard

<figure>
  <kbd>
    <img src="./images/1.png">
  </kbd>
  <figcaption>The dashboard with 30-day view loaded.</figcaption>
</figure>

### Manage Events

<figure>
  <kbd>
    <img src="./images/2.png">
  </kbd>
  <figcaption>List of all events. You can add, edit, remove, and favorite events.</figcaption>
</figure>

### Add Event

<figure>
  <kbd>
    <img src="./images/3.png">
  </kbd>
  <figcaption>To log a run, click on "Add Entry" and select "Run".</figcaption>
</figure>
